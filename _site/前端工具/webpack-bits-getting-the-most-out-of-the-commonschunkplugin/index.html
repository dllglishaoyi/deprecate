<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.3.1 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>webpack å°æœ­: å……åˆ†åˆ©ç”¨ CommonsChunkPlugin()ã€è¯‘ã€‘ - Laoliziâ€™s Blog</title>




<meta name="description" content="      åŸæ–‡åœ°å€ï¼šwebpack bits: Getting the most out of the CommonsChunkPlugin()    ä½œè€…ï¼šSean T. Larkin    ç¿»è¯‘äººï¼šæç»æ‡¿  ">




<meta name="author" content="Laolizi">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="Laolizi's Blog">
<meta property="og:title" content="webpack å°æœ­: å……åˆ†åˆ©ç”¨ CommonsChunkPlugin()ã€è¯‘ã€‘">




  <meta property="og:description" content="      åŸæ–‡åœ°å€ï¼šwebpack bits: Getting the most out of the CommonsChunkPlugin()    ä½œè€…ï¼šSean T. Larkin    ç¿»è¯‘äººï¼šæç»æ‡¿  ">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-03-28T10:01:53+08:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Laolizi",
      "url" : null,
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Laolizi's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="/">Laolizi's Blog</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://github.com/dllglishaoyi">About</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    



<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/avatar.jpeg" class="author__avatar" alt="Laolizi" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">Laolizi</h3>
    
      <p class="author__bio" itemprop="description">
        è€æå­æœæœ
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Being,China</span>
        </li>
      

      

      
        <li>
          <a href="mailto:dllglishaoi@gmail.com">
            <meta itemprop="email" content="dllglishaoi@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      
        <li>
          <a href="https://twitter.com/laolizi" itemprop="sameAs">
            <i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter
          </a>
        </li>
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/dllglishaoyi" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="webpack å°æœ­: å……åˆ†åˆ©ç”¨ CommonsChunkPlugin()ã€è¯‘ã€‘">
    <meta itemprop="description" content="      åŸæ–‡åœ°å€ï¼šwebpack bits: Getting the most out of the CommonsChunkPlugin()    ä½œè€…ï¼šSean T. Larkin    ç¿»è¯‘äººï¼šæç»æ‡¿  ">
    <meta itemprop="datePublished" content="March 28, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">webpack å°æœ­: å……åˆ†åˆ©ç”¨ CommonsChunkPlugin()ã€è¯‘ã€‘
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  1 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <blockquote>
  <ul>
    <li>åŸæ–‡åœ°å€ï¼š<a href="https://medium.com/webpack/webpack-bits-getting-the-most-out-of-the-commonschunkplugin-ab389e5f318#.o691521qn">webpack bits: Getting the most out of the CommonsChunkPlugin()</a></li>
    <li>ä½œè€…ï¼šSean T. Larkin</li>
    <li>ç¿»è¯‘äººï¼š<a href="https://github.com/dllglishaoyi">æç»æ‡¿</a></li>
  </ul>
</blockquote>

<p>webpack æ ¸å¿ƒå›¢é˜Ÿå–œæ¬¢ä¸æ—¶åœ°å‚ä¸åˆ°Twitterç¤¾åŒºä¸­ï¼Œé€šè¿‡<a href="https://twitter.com/TheLarkInn/status/842817690951733248">ä¸€äº›æœ‰è¶£å¹¶ä¸”æœ‰è¥å…»çš„æ–¹å¼åˆ†äº«çŸ¥è¯†</a>ã€‚</p>

<p><img src="/assets/demo.gif" alt="å›¾ç‰‡" /></p>

<p><img src="/assets/20170328/twitter1.png" alt="å›¾ç‰‡" /></p>

<p>è¿™ä¸€æ¬¡ï¼Œâ€œæ¸¸æˆè§„åˆ™â€å¾ˆç®€å•ã€‚å®‰è£… webpack-bundle-analyzer ï¼Œç”Ÿæˆä¸€å¼ ç²¾ç¾å¤šå½©çš„å›¾ç‰‡ï¼ŒåŒ…å«äº†ä½ æ‰€æœ‰çš„bundleï¼Œç„¶ååˆ†äº«ç»™æˆ‘ã€‚ä½œä¸ºå›æŠ¥ï¼Œwebpackå›¢é˜Ÿä¼šå¸®ä½ æŒ‡å‡ºä¸€äº›æˆ‘ä»¬èƒ½è¾¨è®¤çš„æ½œåœ¨é—®é¢˜ã€‚</p>

<h2 id="æˆ‘ä»¬å‘ç°äº†ä»€ä¹ˆ">æˆ‘ä»¬å‘ç°äº†ä»€ä¹ˆï¼Ÿ</h2>

<p>æœ€å¸¸è§çš„é—®é¢˜å°±æ˜¯ä»£ç é‡å¤ï¼šé‡å¤çš„ç±»åº“ã€ç»„ä»¶ã€ä»£ç å­˜åœ¨äºå¤šä¸ªï¼ˆåŒæ­¥æˆ–å¼‚æ­¥ï¼‰çš„bundleé‡Œï¼</p>

<h2 id="ä¾‹å­1å¾ˆå¤šå¸¦æœ‰é‡å¤ä»£ç çš„-vendor-bundle">ä¾‹å­1ï¼šå¾ˆå¤šå¸¦æœ‰é‡å¤ä»£ç çš„ vendor bundle</h2>
<p><br />
<img src="/assets/20170328/case1.png" alt="å›¾ç‰‡" />
<img src="/assets/20170328/twitter2.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
    è¿™æ˜¯ä¸€ä¸ªå…¸å‹ä¾‹å­ã€‚Swizecè°¢è°¢ä½ è®©æˆ‘åˆ†äº«å®ƒã€‚
</center>
<p><br />
<a href="https://medium.com/@swizec">Swizec Teller</a>äººå¾ˆå¥½ï¼Œåˆ†äº«äº†ä»–çš„ä¸€ä¸ªæ„å»ºï¼ˆå®é™…ä¸Šæ˜¯åŒ…å«äº†8-9ä¸ªç‹¬ç«‹å•é¡µçš„åº”ç”¨ï¼‰ã€‚æˆ‘ä»ä¸­æŒ‘é€‰äº†è¿™ä¸ªä¾‹å­å› ä¸ºå¯ä»¥ä»ä¸­è¾¨è®¤å‡ºå¾ˆå¤šå¾ˆæ£’çš„æŠ€æœ¯ã€‚è®©æˆ‘ä»¬å…·ä½“æ¥çœ‹çœ‹ï¼š
<br />
<br />
<img src="/assets/20170328/case1.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
    é™¤äº†â€œFoamTreeâ€å›¾è¡¨ä¹‹å¤–éƒ½æ˜¯åº”ç”¨çš„ä»£ç ï¼Œä¸æ­¤åŒæ—¶ï¼Œæ‰€æœ‰ç”¨äº†node_modulesèµ„æºçš„éƒ¨åˆ†éƒ½ä»¥"\_vendor.js" ç»“å°¾
</center>
<p><br />
æˆ‘ä»¬å¯ä»¥ä»ä¸­æ¨æ–­å‡ºä¸å°‘ä¸œè¥¿ï¼ˆåœ¨ä¸çœ‹å…·ä½“é…ç½®çš„æƒ…å†µä¸‹ï¼‰ã€‚
<br /></p>

<p>æ¯ä¸ªå•é¡µåº”ç”¨éƒ½ä»…ä»…åœ¨å…¥å£å’Œvendorä»£ç ä¸­ç”¨äº† <em>CommonsChunkPlugin</em> æ’ä»¶ã€‚è¿™åˆ›å»ºäº†ä¸€ä¸ªåªåŒ…å«æ¥è‡ªnode_modulesæ–‡ä»¶ä»£ç çš„bundleï¼Œå¹¶ä¸”å…¶ä»–çš„bundleåªåŒ…å«äº†åº”ç”¨ä»£ç ã€‚ä»¥ä¸‹æ˜¯éƒ¨åˆ†ç›¸å…³é…ç½®ï¼š
<img src="/assets/20170328/twitter3.png" alt="å›¾ç‰‡" /></p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">activeApps</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">app</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">app</span><span class="p">}</span><span class="nx">_vendor</span><span class="err">`</span><span class="p">,</span>
    <span class="na">chunks</span><span class="p">:</span> <span class="p">[</span><span class="nx">app</span><span class="p">],</span>
    <span class="na">minChunks</span><span class="p">:</span> <span class="nx">isVendor</span>
  <span class="p">}))</span></code></pre></figure>

<p><em>activeApps</em> å˜é‡ä»£è¡¨äº†æ¯ä¸ªç‹¬ç«‹çš„å…¥å£ç‚¹ã€‚</p>

<h2 id="æœºä¼šåŒºåŸŸ">æœºä¼šåŒºåŸŸ</h2>

<p>ä¸‹é¢æ˜¯æˆ‘åœˆå‡ºæ¥å¯ä»¥åšä¸€äº›æ”¹å–„çš„åŒºåŸŸã€‚
<br />
<br />
<img src="/assets/20170328/case1_2.png" alt="å›¾ç‰‡" /></p>
<h2 id="å…ƒ-ç¼“å­˜">â€œå…ƒâ€ ç¼“å­˜</h2>

<p>æˆ‘ä»¬ä¸Šé¢çœ‹åˆ°çš„æ˜¯å„ç§è¯¸å¦‚ momentjs, lodash å’Œ jquery çš„åºå¤§ç±»åº“ç©¿æ’åœ¨6ä¸ªç”šè‡³æ›´å¤šçš„vendor bundleä¸­ä½¿ç”¨ã€‚æŠŠæ‰€æœ‰vendoræ‰“åŒ…åˆ°ä¸€ä¸ªå•ç‹¬bundleçš„ç­–ç•¥å›ºç„¶æ˜¯å¥½çš„ï¼Œä½†æˆ‘ä»¬ä¹Ÿåº”è¯¥ç›¸åŒçš„ç­–ç•¥åº”ç”¨åˆ°æ‰€æœ‰çš„ vendor bundleå†…éƒ¨ã€‚</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
  <span class="na">children</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">minChunks</span><span class="p">:</span> <span class="mi">6</span>
<span class="p">})</span></code></pre></figure>

<p>è¿™ç›¸å½“äºæˆ‘ä»¬å‘Šè¯‰webpack:</p>
<blockquote>
  <p>å˜¿ï¼Œwebpack, çœ‹çœ‹æ‰€æœ‰çš„ chunk ï¼ˆåŒ…æ‹¬å·²ç”Ÿæˆçš„vendorï¼‰ï¼Œç„¶åæŠŠå‡ºç°åœ¨6ä¸ªä»¥ä¸Šchunkä¸­çš„æ¨¡å—æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸­ã€‚</p>
</blockquote>

<p><img src="/assets/20170328/case1_3.jpg" alt="å›¾ç‰‡" />
<img src="/assets/20170328/twitter4.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
    åœ¨è¿™ä¸ªä¾‹å­ä¸­è¿™ä¸ªæ–‡ä»¶ä¼¼ä¹è¢«å‘½åä¸ºâ€œmanifest.jsâ€
</center>
<p><img src="/assets/20170328/twitter5.png" alt="å›¾ç‰‡" />
<br />
<br />
æ­£å¦‚ä½ æ‰€è§ï¼Œæ‰€æœ‰çš„ç‰¹å®šæ¨¡å—è¢«æŠ½ç¦»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ï¼Œå¹¶ä¸”æ®
Swizecè¯´ï¼Œè¿™è®©ä»–ä»¬çš„åº”ç”¨å¤§å°æ•´ä½“ä¸‹é™äº†17%!</p>
<h2 id="ä¾‹å­2å¼‚æ­¥-chunk-ä¹‹é—´çš„é‡å¤-vendor">ä¾‹å­2ï¼šå¼‚æ­¥ chunk ä¹‹é—´çš„é‡å¤ vendor</h2>
<p><img src="/assets/20170328/twitter6.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
    è¿™æ˜¯ä¸ªä»¤äººå°è±¡æ·±åˆ»çš„ä»£ç æ‹†åˆ†ç”¨æ³•ã€‚ç§ç§è¿™äº›æ¼‚äº®çš„é¢œè‰² ğŸ’“
</center>
<p><br />
<br />
æ‰€ä»¥è¿™ä¸ªä»£ç çš„é‡å¤é‡ç›¸å¯¹æ•´ä½“ä»£ç ä¸é‚£ä¹ˆä¸¥é‡å§ï¼Œç„¶è€Œï¼Œå½“ä½ çœ‹åˆ°ä¸‹é¢å…¨é‡ä»£ç ä½“ç§¯çš„å›¾æ—¶ï¼Œä½ ä¼šå‘ç°æœ‰ä¸‰ä¸ªåŒæ ·çš„æ¨¡å—å­˜åœ¨äºæ¯ä¸ªå¼‚æ­¥chunkä¸­ã€‚
<br />
<br />
<img src="/assets/20170328/case2.jpeg" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
    å¼‚æ­¥chunkå°±æ˜¯æ–‡ä»¶åä¸ºâ€œ[number].[number].jsâ€çš„æ–‡ä»¶
</center>
<p><br />
<br />
æ­£å¦‚ä½ åœ¨ä¸Šé¢çœ‹è§çš„ï¼Œæœ‰2ï¼Œ3ä¸ªç›¸åŒçš„ç»„ä»¶ç”¨åˆ°äº†å››äº”åä¸ªå¼‚æ­¥bundleä¸­ã€‚é‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆé€šè¿‡ <em>CommonsChunkPlugin</em> è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</p>
<h2 id="åˆ›å»ºå¼‚æ­¥çš„-commons-chunk">åˆ›å»ºå¼‚æ­¥çš„ Commons Chunk</h2>
<p>è¿™ä¸ªæŠ€æœ¯å’Œç¬¬ä¸€ä¸ªéå¸¸ç›¸ä¼¼ï¼Œæˆ‘ä»¬è¦æŠŠé…ç½®æ–‡ä»¶ä¸­çš„ <em>async</em> å±æ€§è®¾ä¸º <em>true</em> ï¼Œåƒè¿™æ ·ï¼š</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
  <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">children</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
  <span class="na">filename</span><span class="p">:</span> <span class="s2">"commonlazy.js"</span>
<span class="p">});</span></code></pre></figure>

<p>ç”¨åŒæ ·çš„æ–¹å¼ - webpack ä¼šæ‰«ç æ‰€æœ‰çš„ chunk æ¥æŸ¥æ‰¾é€šç”¨æ¨¡å—ã€‚å½“asyncä¸ºtrueæ—¶ï¼Œåªæœ‰æ‹†åˆ†ä»£ç çš„bundleæ‰ä¼šè¢«æ‰«æã€‚
ç”±äºæˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®š<em>minChunks</em>ï¼Œæ‰€ä»¥é»˜è®¤å€¼æ˜¯3ã€‚webpackç›¸å½“äºè¢«å‘ŠçŸ¥ï¼š</p>
<blockquote>
  <p>å˜¿ï¼Œwebpack, æŸ¥çœ‹æ‰€æœ‰çš„å¸¸è§„ï¼ˆåˆç§°æ‡’åŠ è½½ï¼‰chunkï¼Œå¦‚æœä½ æ‰¾åˆ°äº†å‡ºç°åœ¨3ä¸ªä»¥ä¸Šchunkä¸­çš„ç›¸åŒæ¨¡å—ï¼Œé‚£ä¹ˆè¯·æŠŠå®ƒæŠ½ç¦»åˆ°ä¸€ä¸ªå•ç‹¬çš„å¼‚æ­¥é€šç”¨chunkä¸­ã€‚</p>
</blockquote>

<p>æœ€ç»ˆçš„ç»“æœå°±æ˜¯ï¼š
<img src="/assets/20170328/case2_2.jpg" alt="å›¾ç‰‡" />
<img src="/assets/20170328/twitter7.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
å¯èƒ½æœ‰æ›´å¤§çš„minChunkså€¼ï¼Œæ¥äº§ç”Ÿä¸€ä¸ªæ›´å°çš„commonlazy.jsåŒ…
</center>
<p><br />
<br />
ç°åœ¨çš„å¼‚æ­¥chunkå·²ç»éå¸¸å°äº†ï¼Œå¹¶ä¸”æ‰€æœ‰çš„ä»£ç éƒ½èšåˆåˆ°äº†ä¸€ä¸ªå« <em>commonlazy.js</em> çš„æ–‡ä»¶ä¸­ã€‚ç”±äºè¿™äº›bundleå·²ç»å¾ˆå°äº†ï¼Œæ‰€ä»¥å¤§å°çš„å½±å“ç›´è‡³ç¬¬äºŒæ¬¡è®¿é—®éƒ½ä¸æ˜¯å¾ˆæ˜æ˜¾ã€‚
ç°åœ¨ï¼Œè¢«åˆ†éš”åˆ°æ¯ä¸ªbundleä¸­çš„ä»£ç å°‘äº†å¾ˆå¤šï¼Œæˆ‘ä»¬é€šè¿‡å°†è¿™äº›é€šç”¨æ¨¡å—æ”¾å…¥å•ç‹¬çš„å¯é«˜é€Ÿç¼“å­˜çš„chunkä¸­æ¥èŠ‚çœç”¨æˆ·åŠ è½½æ—¶é—´å’Œæ•°æ®çš„æ¶ˆè€—ã€‚</p>

<h2 id="æ›´è¿›ä¸€æ­¥æ§åˆ¶-minchunks-å‡½æ•°">æ›´è¿›ä¸€æ­¥æ§åˆ¶: minChunks å‡½æ•°</h2>
<p><img src="/assets/20170328/twitter8.png" alt="å›¾ç‰‡" />
<br />
<br />
å¦‚æœä½ æƒ³è¦æ›´å¤šæ§åˆ¶ä¼šæ€ä¹ˆæ ·ï¼Ÿæœ‰æ—¶å€™ä½ å¹¶ä¸æƒ³è¦å•ä¸ªå…±äº«çš„bundleï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ¯ä¸ª <em>æ‡’/å…¥å£</em> chunk éƒ½ä¼šç”¨åˆ°å®ƒã€‚ <em>minChunks</em> å±æ€§ä¹Ÿæ”¯æŒ function ï¼ï¼è¿™å¯ä»¥è®©ä½ ç­›é€‰å“ªäº›æ¨¡å—ä¼šè¢«åŠ å…¥ä½ æ–°çš„bundleä¸­ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
  <span class="na">filename</span><span class="p">:</span> <span class="s2">"lodash-moment-shared-bundle.js"</span><span class="p">,</span>
  <span class="na">minChunks</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">module</span><span class="p">.</span><span class="nx">resource</span> <span class="o">&amp;&amp;</span> <span class="sr">/lodash|moment/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">module</span><span class="p">.</span><span class="nx">resource</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span> <span class="o">&gt;=</span> <span class="mi">3</span>
  <span class="p">}</span>
<span class="p">})</span></code></pre></figure>

<p>ä¸Šé¢çš„ä¾‹å­å°±æ˜¯è¯´ï¼š</p>

<blockquote>
  <p>å“Ÿï¼Œwebpack, å½“ä½ æ‰«ææ¨¡å—æ—¶å€™ï¼Œå¦‚æœæ¨¡å—çš„ç»å¯¹è·¯å¾„åŒ¹é…åˆ°äº†lodashæˆ–è€…momentjså¹¶ä¸”å‡ºç°åœ¨äº†ä¸‰ä¸ªå…¥å£æ–‡ä»¶ä¸­ï¼Œé‚£ä¹ˆæŠŠè¿™äº›æ¨¡å—æ‰“åŒ…åˆ°ä¸€ä¸ªbundleä¸­ã€‚</p>
</blockquote>

<p>ä½ å¯ä»¥é€šè¿‡è®¾ç½®â€œasyncï¼štrueâ€å°†åŒæ ·çš„è¡Œä¸ºåº”ç”¨äºå¼‚æ­¥bundleã€‚</p>

<h2 id="å†å¤šçš„æ§åˆ¶">å†å¤šçš„æ§åˆ¶</h2>
<p><img src="/assets/20170328/twitter9.png" alt="å›¾ç‰‡" /></p>

<p>é€šè¿‡è¿™ä¸ª <em>minChunks</em> ä½ å¯ä»¥ä¸ºç‰¹å®šçš„å…¥å£å’Œbundleåˆ›å»ºæ›´å°çš„å¯ç¼“å­˜vendoré›†åˆã€‚æœ€åï¼Œä½ çœ‹åˆ°çš„å¯èƒ½ä¼šæ˜¯è¿™æ ·ï¼š</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">function</span> <span class="nx">lodashMomentModuleFilter</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">module</span><span class="p">.</span><span class="nx">resource</span> <span class="o">&amp;&amp;</span> <span class="sr">/lodash|moment/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">module</span><span class="p">.</span><span class="nx">resource</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">immutableReactModuleFilter</span><span class="p">(</span><span class="nx">module</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">module</span><span class="p">.</span><span class="nx">resource</span> <span class="o">&amp;&amp;</span> <span class="sr">/immutable|react/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">module</span><span class="p">.</span><span class="nx">resource</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">count</span> <span class="o">&gt;=</span><span class="mi">4</span>
<span class="p">}</span>
<span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
  <span class="na">filename</span><span class="p">:</span> <span class="s2">"lodash-moment-shared-bundle.js"</span><span class="p">,</span>
  <span class="na">minChunks</span><span class="p">:</span> <span class="nx">lodashMomentModuleFilter</span>
<span class="p">})</span>
<span class="k">new</span> <span class="nx">webpack</span><span class="p">.</span><span class="nx">optimize</span><span class="p">.</span><span class="nx">CommonsChunkPlugin</span><span class="p">({</span>
  <span class="na">filename</span><span class="p">:</span> <span class="s2">"immutable-react-shared-bundle.js"</span><span class="p">,</span>
  <span class="na">minChunks</span><span class="p">:</span> <span class="nx">immutableReactModuleFilter</span>
<span class="p">})</span></code></pre></figure>

<h2 id="æ²¡æœ‰é“¶å¼¹">æ²¡æœ‰é“¶å¼¹ï¼</h2>

<p><em>CommonsChunkPlugin()</em> æˆ–è®¸å¾ˆå¼ºå¤§ï¼Œä½†è¯·è®°ä½ï¼Œè¿™äº›ä¾‹å­éƒ½æœ‰å®ƒä»¬æ‰€é€‚ç”¨çš„åœºæ™¯ã€‚æ‰€ä»¥å½“ä½ å¤åˆ¶ç²˜è´´è¿™äº›ä»£ç ç‰‡æ®µä¹‹å‰ï¼Œä»<a href="https://medium.com/@samccone">Sam Saccone</a>ã€<a href="https://medium.com/@paul_irish">Paul Irish</a>è¿˜æœ‰<a href="https://youtu.be/6m_E-mC0y3Y?t=11m38s">MPDIA</a>é‚£å…ˆè·å¾—ä¸€äº›å»ºè®®ï¼Œä»¥ç¡®ä¿ä½ ä½¿ç”¨çš„æ˜¯æ­£ç¡®æ–¹æ¡ˆã€‚</p>

<p><img src="/assets/20170328/advice.png" alt="å›¾ç‰‡" /></p>
<center style="font-size:12px;color:#9a9a9a">
åœ¨è¿ç”¨è§£å†³æ–¹æ¡ˆä¹‹å‰ï¼Œè¯·åŠ¡å¿…äº†è§£ä½ çš„è¿›ç¨‹
</center>

<h2 id="ä»å“ªæ‰¾åˆ°æ›´å¤šçš„ä¾‹å­">ä»å“ªæ‰¾åˆ°æ›´å¤šçš„ä¾‹å­ï¼Ÿ</h2>
<p>è¿™äº›åªæ˜¯ä½¿ç”¨å’Œé…ç½® <em>CommonsChunkPlugin()</em> çš„ä¾‹å­ã€‚è¦æƒ³äº†è§£æ›´å¤šï¼Œåœ¨æˆ‘ä»¬çš„ webpack/webpack GitHub æ ¸å¿ƒä»“åº“ä¸­æŸ¥çœ‹ <em>/examples</em> ç›®å½•ï¼å¦‚æœä½ è¿˜æœ‰æ›´å¥½çš„æƒ³æ³•,æ¬¢è¿æäº¤PR!</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#webpack" class="page__taxonomy-item" rel="tag">Webpack</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7" class="page__taxonomy-item" rel="tag">å‰ç«¯å·¥å…·</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-03-28T10:01:53+08:00">March 28, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=webpack å°æœ­: å……åˆ†åˆ©ç”¨ CommonsChunkPlugin()ã€è¯‘ã€‘ /%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/webpack-bits-getting-the-most-out-of-the-commonschunkplugin/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=/%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/webpack-bits-getting-the-most-out-of-the-commonschunkplugin/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=/%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/webpack-bits-getting-the-most-out-of-the-commonschunkplugin/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=/%E5%89%8D%E7%AB%AF%E5%B7%A5%E5%85%B7/webpack-bits-getting-the-most-out-of-the-commonschunkplugin/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/javascript/give-typescript-another-chance/" class="pagination--pager" title="æ˜¯æ—¶å€™å†ç»™TypeScriptä¸€æ¬¡æœºä¼šäº†ã€è¯‘ã€‘
">Previous</a>
    
    
      <a href="#" class="pagination--pager disabled">Next</a>
    
  </nav>

    </div>

    
    <div id="disqus_thread"></div>
  </article>

    <script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://laolizi.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/dllglishaoyi"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Laolizi. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>
      </footer>
    </div>

    <script src="/assets/js/main.min.js"></script>





  </body>
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-96338582-1', 'auto');
      ga('send', 'pageview');

    </script>
</html>
